---
layout: post
title: Figure and Table Captions in Markdown
date: "Friday, September 17, 2015"
tags: [R, Markdown, captioner, Reproducible_Research]
output: html_document
---
```{r eval=FALSE, echo=FALSE}
## FOR COMPILING FOR THE WEBSITE
## Make sure to setwd to source file location
source("rmd2md.R")
rmd2md("2015-09-17-Figure-Table-Captions-in-Markdown")
```

```{r setup, echo=FALSE, results='hide'}
library(knitr)
opts_chunk$set(dev="png",tidy=FALSE)
```

## The Problem

I have been attempting to use RMarkdown rather than LaTeX to produce R examples.  One issue that has slowed my conversion has been my struggles with how to reference figures and tables.  The examples below illustrate how I have been using `captioner` to solve this problem.

## The Solution

### Foundation

For a simple example, I load `FSAdata` for the `RuffeSLRH92` data, `FSA` for `hist()` and `summarize()`, and `knitr` for `kable` (to produce an RMarkdown table).  Additionally, `captioner` is loaded.
```{r message=FALSE, warning=FALSE}
library(FSAdata)
data(RuffeSLRH92)
library(FSA)
library(knitr)
library(captioner)
```

Separate `captioner` objects must be initialized for handling figures and tables.  The `prefix=` argument sets the common prefix for all items of a certain type.  Below, I initialize a function for creating captoins for figures and tables.  The result of this code is two functions -- one called `figs` that will hold a list of tags and captions for figures and another called `tbls` that will hold the same for tables.
```{r}
figs <- captioner(prefix="Figure")
tbls <- captioner(prefix="Table")
```

These functions can be used to create on object that holds a tag, caption, and number for figures or tables, respectively.  Initially, these functions are called with two arguments -- the figure or table tag and the figure or table caption.  For example, the code below creates tag and caption combinations for two figures.  I prefer to create all tags and captions in one chunk (and use `results='hide'` to hide the immediate display of the information).
```{r results='hide'}
figs(name="LenFreq1","Length frequency of Ruffe captured in 1992.")
figs(name="WtFreq1","Weight frequency of Ruffe captured in 1992.")
```

The same function may then be used to retrieve the function name with a number, the figure number with a prefix, or the figure number.
```{r}
figs("LenFreq1")
figs("LenFreq1",display="cite")
figs("LenFreq1",display="num")
```

The results returned by this function are exploited, as shown in the next section, to solve the figure referencing problem.

### Application

The `figs` function may be used to add a figure caption to a figure.  For example, the chunk below is followed by an inline R chunk of `r figs("LenFreq1")`.
```{r ExHistL_Captioner}
hist(~length,data=RuffeSLRH92)
```

`r figs("LenFreq1")`

In addition, use inline R code to refer to the figure.  For example, `figs("LenFreq1",display="cite")` inside an inline R call would produce a reference to `r figs("LenFreq1",display="cite")`.

As more functions are added, the figure numbers are incremented such that inline R code may refer to `r figs("WtFreq1",display="cite")` and `r figs("LenFreq1",display="cite")`.

```{r ExHistW_Captioner, fig.cap=figs("WtFreq1")}
hist(~weight,data=RuffeSLRH92)
```

`r figs("WtFreq1")`

Tables can be handled in the same way.  For example, see `r tbls("sumLW1",display="cite")`, which is related to `r figs("LenFreq1",display="cite")` and `r figs("WtFreq1",display="cite")`.
```{r results='hide'}
tbls("SumLW1","Summary statistics of the length and weight of Ruffe captured in 1992.")
```

```{r}
sumLW <- rbind(Summarize(~length,data=RuffeSLRH92),
               Summarize(~length,data=RuffeSLRH92))
```

`r tbls("SumLW1")`

```{r echo=FALSE, results='markup'}
sumLW
```

